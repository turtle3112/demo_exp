<!DOCTYPE html>
<html lang="vi">

<head>
	<meta charset="UTF-8">
	<title>Danh sách công việc</title>
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link href="css/styles.css" rel="stylesheet">
</head>

<body class="container py-4">

	<div class="d-flex justify-content-between align-items-center mb-4">
		<h3 id="projectTitle">Công việc trong dự án</h3>
		<div class="d-flex gap-2">
			<button onclick="window.location.href = 'dashboard.html'" id="btnDashboard"
				class="btn btn-outline-secondary btn-sm d-none">Dashboard</button>
			<button id="createTaskBtn" class="btn btn-primary d-none" data-bs-toggle="modal"
				data-bs-target="#createTaskModal">Tạo công việc</button>
			<button id="editProjectBtn" class="btn btn-warning d-none" data-bs-toggle="modal"
				data-bs-target="#editProjectModal">Sửa dự án</button>
			<button id="deleteProjectBtn" class="btn btn-danger d-none"> Xoá dự án</button>
			<button onclick="window.location.href='projects.html'" class="btn btn-outline-secondary btn-sm">Quay
				lại</button>

			<!-- Modal tạo task -->
			<div class="modal fade" id="createTaskModal" tabindex="-1">
				<div class="modal-dialog">
					<form class="modal-content" id="createTaskForm">
						<div class="modal-header">
							<h5 class="modal-title">Tạo công việc</h5>
							<button type="button" class="btn-close" data-bs-dismiss="modal"></button>
						</div>
						<div class="modal-body">
							<div class="mb-3">
								<label class="form-label">Tên công việc</label>
								<input type="text" class="form-control" id="taskName" />
							</div>
							<div class="mb-3">
								<label class="form-label">Mô tả</label>
								<textarea class="form-control" id="taskDesc"></textarea>
							</div>
							<div class="mb-3">
								<label class="form-label">Deadline</label>
								<input type="date" class="form-control" id="taskDeadline" />
							</div>
							<div class="mb-3">
								<label class="form-label">Phân công nhân viên</label>
								<div id="userCheckboxList" class="border rounded p-2"
									style="max-height: 200px; overflow-y: auto;">
								</div>
							</div>
						</div>
						<div class="modal-footer">
							<button type="submit" class="btn btn-primary">Tạo</button>
							<button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Huỷ</button>
						</div>
					</form>
				</div>
			</div>
		</div>
	</div>


	<!-- Modal sửa dự án -->
	<div class="modal fade" id="editProjectModal" tabindex="-1">
		<div class="modal-dialog modal-lg">
			<div class="modal-content">
				<div class="modal-header">
					<h5 class="modal-title">Chỉnh sửa Dự án</h5>
					<button type="button" class="btn-close" data-bs-dismiss="modal"></button>
				</div>
				<div class="modal-body">
					<div class="mb-3">
						<label>Tên dự án</label>
						<input type="text" class="form-control" id="editProjectName" />
					</div>
					<div class="mb-3">
						<label>Mô tả dự án</label>
						<textarea class="form-control" id="editProjectDescription" rows="3"></textarea>
					</div>
					<div class="mb-3">
						<label>Phân công nhân viên</label>
						<div id="projectUserCheckboxes"></div>
					</div>
				</div>
				<div class="modal-footer">
					<button class="btn btn-secondary" data-bs-dismiss="modal">Hủy</button>
					<button class="btn btn-primary" onclick="saveProjectEdit()">Lưu thay đổi</button>
				</div>
			</div>
		</div>
	</div>



	<!-- Search + Filter + Sort -->
	<div class="row mb-3">
		<div class="col-md-4">
			<input type="text" id="searchInput" class="form-control" placeholder="Tìm kiếm theo tên task...">
		</div>
		<div class="col-md-4">
			<select id="statusFilter" class="form-select">
				<option value="">Tất cả trạng thái</option>
				<option value="TODO">Chưa làm</option>
				<option value="IN_PROGRESS">Đang làm</option>
				<option value="DONE">Hoàn thành</option>
			</select>
		</div>
		<div class="col-md-4">
			<select id="sortSelect" class="form-select">
				<option value="">-- Sắp xếp --</option>
				<option value="name">Tên</option>
				<option value="deadline">Deadline</option>
			</select>
		</div>
	</div>

	<!-- Danh sách task -->
	<div id="taskList" class="row"></div>

	<!-- Modal cảnh báo nếu không được phân công -->
	<div class="modal fade" id="unauthorizedModal" tabindex="-1">
		<div class="modal-dialog modal-dialog-centered">
			<div class="modal-content">
				<div class="modal-header">
					<h5 class="modal-title">Thông báo</h5>
					<button type="button" class="btn-close" data-bs-dismiss="modal"></button>
				</div>
				<div class="modal-body">Bạn không được phân công vào công việc này.</div>
				<div class="modal-footer">
					<button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Đóng</button>
				</div>
			</div>
		</div>
	</div>
	<script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
	<script src="js/tasks.js"></script>
	<script src="js/auth-check.js"></script>
</body>

</html>